__author__ = 'mongolrgata'

import re
import sys

import byteshift

prefix = \
    b'\xA4\xA8\x00\x00\x00\x00\x00\x7C\xA8\x00\x00\x00\x00\x00\xC8\x00' \
    b'\xA1\x04\x5C\xC5\x04\x0C\xFD\x00\x00\x00\x00\x00\x00\x00\x00\x00' \
    b'\xA4\x00\x00\x00\x18\x2D\x04\x00\x00\x2C\xF7\x0C\x04\x68\xBD\xC1' \
    b'\x95\xB9\x51\xA5\xD1\xB1\x95\x00\x04\x0A\x8D\x00\x00\x00\x23\x09' \
    b'\xA6\x00\x00\x00\x2D\x04\x00\x00\xDC\xA8\x00\xCC\x89\x9D\xC0\xC4' \
    b'\x00\x5D\x21\x25\x51\x15\xB8\x41\x39\x1D\x00\x04\x04\xF7\x95\x00' \
    b'\x00\x00\x00\x00\x02\xFC\x00\x00\x00\x00\x00\x00\x24\x00\x28\x00' \
    b'\x00\x00\x02\xFC\x24\x00\x2C\x00\x00\x00\x02\xFC\x24\x00\x30\x00' \
    b'\x00\x00\x02\xFC\x24\x00\x34\x00\x00\x00\x02\xFC\x38\x00\x00\xA3' \
    b'\x0C\x00\x34\x00\x00\x23\x00\x00\x00\x00\x00\x1C'

suffix = \
    b'\x00\x08\x2D\x04\x00\x00\x04\x0A\x8D\x00\x00\x00\x2B\x09\x17\x00' \
    b'\x00\x00\x2D\x04\x00\x00\x6C\x14\x18\x50\x00\x00\x00\x08\x2D\x04' \
    b'\x00\x00\x04\x0A\x8D\x00\x00\x00\x33\x09\x87\x00\x00\x00\x2D\x04' \
    b'\x00\x00\x6C\x04\x18\x50\x00\x00\x00\x08\x2D\x04\x00\x00\x04\x0A' \
    b'\x8D\x00\x00\x00\x3B\x09\xEF\x00\x00\x00\x2D\x04\x00\x00\x18\x2D' \
    b'\x04\x00\x00\x08\x2D\x04\x00\x00\x04\x0A\x8D\x00\x00\x00\x43\x09' \
    b'\xD8\x04\x00\x00\x2D\x04\x00\x00\xDC\xA8\x00\xCC\x89\x9D\xC0\xC4' \
    b'\x00\x5D\x21\x25\x51\x15\xB8\x41\x39\x1D\x00\x04\x04\xF7\x95\x00' \
    b'\x00\x00\x00\x00\x80\x01\x00\x00\x00\x00\x04\x00\x20\x00\x08\x2D' \
    b'\x04\x00\x00\x04\x0A\x8D\x00\x00\x00\x4B\x09\x00\x00\x00\x00\x2D' \
    b'\x04\x00\x00\x18\x7C\x0C\x00\x00\x04\x08\xFD\x00\x00\x00\x00\x00' \
    b'\xC1\x04\x00\x00\x12\x04\x00\x00\x70\xBD\xC1\x95\xB9\x1D\x85\xB1' \
    b'\xB1\x95\xC9\xE5\x00\x00\x00\x00\x08\x12\x04\x00\x00\x2C\xFD\x00' \
    b'\x00\x70\xBD\xC1\x95\xB9\x1D\x85\xB1\xB1\x95\xC9\xE5\x00\x00\x08' \
    b'\x00\x04\x0A\x8D\x00\x00\x00\x02\xFC\x00\x00\x00\x00\x97\x08\x00' \
    b'\x00\x04\x0A\x91\x00\x00\x00\x02\xFC\x00\x00\x00\x00\xBE\x04\x00' \
    b'\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15\xC0\xC4\x00\x04\x0A\x91\x00' \
    b'\x00\x00\x00\x01\x00\x00\x00\x00\x2B\x04\x00\x00\x10\x0D\x1D\x7D' \
    b'\x41\x05\x1D\x15\xC0\xC8\x00\x04\x0A\x91\x00\x00\x00\x01\x01\x00' \
    b'\x00\x00\x00\x97\x04\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15\xC0' \
    b'\xCC\x00\x04\x0A\x91\x00\x00\x00\x02\x01\x00\x00\x00\x00\x00\x08' \
    b'\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15\xC0\xD0\x00\x04\x0A\x91' \
    b'\x00\x00\x00\x82\x01\x00\x00\x00\x00\x6C\x08\x00\x00\x10\x0D\x1D' \
    b'\x7D\x41\x05\x1D\x15\xC0\xD4\x00\x04\x0A\x91\x00\x00\x00\x03\x01' \
    b'\x00\x00\x00\x00\xD8\x08\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15' \
    b'\xC0\xD8\x00\x04\x0A\x91\x00\x00\x00\x83\x01\x00\x00\x00\x00\x45' \
    b'\x08\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15\xC0\xDC\x00\x04\x0A' \
    b'\x91\x00\x00\x00\x00\x05\x00\x00\x00\x00\xB1\x08\x00\x00\x10\x0D' \
    b'\x1D\x7D\x41\x05\x1D\x15\xC0\xE0\x00\x04\x0A\x91\x00\x00\x00\x40' \
    b'\x05\x00\x00\x00\x00\x1E\x08\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D' \
    b'\x15\xC0\xE4\x00\x04\x0A\x91\x00\x00\x00\x80\x05\x00\x00\x00\x00' \
    b'\x8A\x08\x00\x00\x10\x0D\x1D\x7D\x41\x05\x1D\x15\xC4\xC0\x00\x04' \
    b'\x0A\x91\x00\x00\x00\xC0\x05\x00\x00\x00\x00\xF6\x08\x00\x00\x10' \
    b'\x0D\x1D\x7D\x41\x05\x1D\x15\xC4\xC4\x00\x04\x0A\x91\x00\x00\x00' \
    b'\x01\x05\x00\x00\x00\x00\x73\x08\x00\x00\x2C\xF9\x00\x04\x10\x0D' \
    b'\x1D\x7D\x41\x05\x1D\x15\xC4\xC8\x00\x2C\xF9\x00\x00\x18\x2D\x04' \
    b'\x00\x00\x04\x0A\x8D\x00\x00\x00\x00\x01\x00\x00\x00\x00\x68\x0C' \
    b'\x00\x00\x2C\xFD\x00\x04\x04\x02\xB9\x00\x00\x00\x02\xFC\x00\x00' \
    b'\x00\x00\x54\x0C\x00\x00\x1C\x49\x15\x41\x31\x05\x65\x7D\x15\x61' \
    b'\x15\x00\x18\x2D\x04\x00\x00\x18\x50\x00\x00\x00\x70\xBD\xC1\x95' \
    b'\xB9\x05\x99\xD1\x95\xC9\x00\x00\x00\x00\x04\x0A\x8D\x00\x00\x00' \
    b'\x02\xFC\x00\x00\x00\x00\xC5\x0C\x00\x00\xDC\xA8\x00\xCC\x89\x9D' \
    b'\xC0\xC4\x00\x5D\x21\x25\x51\x15\xB8\x41\x39\x1D\x00\x04\x04\xF7' \
    b'\x95\x00\x00\x00\x00\x00\x02\xFC\x00\x00\x00\x00\x00\x00\x2C\xF9' \
    b'\x00\x04\x1C\x4D\x31\x7D\x2D\x3D\x51\x7D\xC0\xC0\xC4\x00\x04\x0A' \
    b'\x8D\x00\x00\x00\x00\x01\x00\x00\x00\x00\xD6\x0C\x00\x00\xDC\xA8' \
    b'\x00\xCC\x89\x9D\xC0\xC4\x00\x5D\x21\x25\x51\x15\xB8\x41\x39\x1D' \
    b'\x00\x04\x04\xF7\x95\x00\x00\x00\x00\x00\x02\xFC\x00\x00\x00\x00' \
    b'\x00\x00\x2C\xF9\x00\x04\x1C\x4D\x31\x7D\x05\x1D\x15\x7D\xC0\xC0' \
    b'\xC4\x00\x04\x0A\x8D\x00\x00\x00\x01\x01\x00\x00\x00\x00\xE7\x0C' \
    b'\x00\x00\xDC\xA8\x00\xCC\x89\x9D\xC0\xC4\x00\x5D\x21\x25\x51\x15' \
    b'\xB8\x41\x39\x1D\x00\x04\x04\xF7\x95\x00\x00\x00\x00\x00\x02\xFC' \
    b'\x00\x00\x00\x00\x00\x00\x2C\xF9\x00\x04\x1C\x4D\x31\x7D\x05\x35' \
    b'\x05\x7D\xC0\xC0\xC4\x00\x04\x0A\x8D\x00\x00\x00\x02\x01\x00\x00' \
    b'\x00\x00\xF4\x10\x00\x00\xDC\xA8\x00\xCC\x89\x9D\xC0\xC4\x00\x5D' \
    b'\x21\x25\x51\x15\xB8\x41\x39\x1D\x00\x04\x04\xF7\x95\x00\x00\x00' \
    b'\x00\x00\x02\xFC\x00\x00\x00\x00\x00\x00\x2C\xF9\x00\x04\x1C\x4D' \
    b'\x31\x7D\x21\x55\x51\x7D\xC0\xC0\xC4\x00\x18\x50\x00\x00\x00\xFF' \
    b'\x00\x00\x00\x00\x00\x00\x00\x00'


def main():
    chapter_name = byteshift.shift_encode(sys.argv[1].encode())

    with open('Rio.arc', 'r+b') as rio_arc:
        content = rio_arc.read()

        content = re.sub(
            re.escape(prefix) + b'(.*?)' + re.escape(suffix),
            prefix + chapter_name + suffix,
            content
        )

        rio_arc.seek(0)
        rio_arc.write(content)
        rio_arc.truncate()


if __name__ == '__main__':
    main()
